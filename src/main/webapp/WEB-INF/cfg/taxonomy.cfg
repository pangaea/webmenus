<?xml version="1.0" encoding="UTF-8"?>

<!-- Copyright (C) 2004-2009 Kevin Jacovelli, All Rights Reserved -->

<!--
	D A T A S P H E R E :   O B J E C T   M A N A G E R  -  T A X O N O M Y   F I L E
	=================================================================================
	This is the server taxonomy file. It describes the "Business Layer Classes"
	of the server. All classes described here inherit from
	a single base class called "ServerObject". This classes implements three
	methods called "query", "insert", "update", and "delete".

	Abstracts:
	> sql - simply specifies a SQL storage device

	Method Calls:
	> These define how a request will be routed to the appropriate place
		> Global Calls - 	Calls not requiring a class reference
							and not associated to an object.
								> login() : login to server
								> logout() : logout of server
		> Class Calls - 	Calls which reference a class but not an object.
								> query() : request for a collection of objects
								> insert() : inserts new object of type <class>
		> Object Calls - 	Object level calls, otherwise referred to as "methods".
								> update() : make changes to local object
								> delete() : deletes local object

	Rules:
	1) You cannot name a property "class", "id", "owner", "created", "author", "modified", or "role".
	   These are reserved words representing object metadata.
-->

<taxonomy version="1.0">

	<!-- SYSTEM CLASSES -->
	<class name="CClient" abstract="sql" table="sys_client" security="public">
		<properties>
			<property name="username" type="text" column="username" required="true"/>
			<property name="password" type="password" column="password" required="true"/>
			<property name="role" type="object" class="CRole" column="roleid"/>
		</properties>
	</class>
	<class name="CAddress" abstract="sql" table="sys_addr" security="public">
		<properties>
			<property name="address" type="text" column="address"/>
			<property name="address2" type="text" column="address2"/>
			<property name="address3" type="text" column="address3"/>
			<property name="city" type="text" column="city"/>
			<property name="state" type="text" column="state"/>
			<property name="zip" type="text" column="zip"><![CDATA[
				^(\d{5}-\d{4})|(\d{5})$
			]]></property>
		</properties>
	</class>
	<class name="CProfile" abstract="sql" table="sys_user" security="public">
		<baseclass name="CAddress"/>
		<properties>
			<property name="firstname" type="text" column="firstname" required="true"/>
			<property name="lastname" type="text" column="lastname" required="true"/>
			<property name="emailaddr" type="text" column="emailaddr" required="true"><![CDATA[
				[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?
			]]></property>
			<property name="phonenum" type="text" column="phonenum"><![CDATA[
				^(1\s*[-\/\.]?)?(\((\d{3})\)|(\d{3}))\s*[-\/\.]?\s*(\d{3})\s*[-\/\.]?\s*(\d{4})\s*(([xX]|[eE][xX][tT])\.?\s*(\d+))*$
			]]></property>
			<property name="show_welcome" type="boolean" column="show_welcome"/>
		</properties>
	</class>
	<class name="CUser" abstract="sql" table="sys_client" security="public">
		<baseclass name="CClient"/>
		<baseclass name="CProfile"/>
		<properties>
			<property name="id" type="text" column="id" readonly="true"/>
		</properties>
	</class>
	<class name="CMyProfile" abstract="sql" table="sys_client" security="private" permit="id">
		<baseclass name="CProfile"/>
		<properties>
			<property name="username" type="text" column="username" readonly="true"/>
			<property name="password" type="password" column="password" required="true"/>
		</properties>
	</class>
	<class name="CRoleRef" abstract="sql" table="sys_role" security="public">
		<properties>
			<property name="id" type="text" column="id" readonly="true"/>
			<property name="name" type="text" column="name"/>
			<property name="description" type="text" column="description"/>
			<property name="admin" type="boolean" column="admin"/>
		</properties>
	</class>
	<class name="CRole" abstract="sql" table="sys_role" security="public">
		<properties>
			<property name="id" type="text" column="id" readonly="true"/>
			<property name="name" type="text" column="name"/>
			<property name="description" type="text" column="description"/>
			<property name="parent" type="object" class="CRoleRef" column="parent"/>
			<property name="admin" type="boolean" column="admin"/>
		</properties>
		<references>
			<reference class="CRoleGroupRef" fkey="role"/>
		</references>
	</class>
	<class name="CRoleGroupRef" abstract="sql" table="sys_role_group_ref" security="public">
		<properties>
			<property name="role" type="object" class="CRole" column="roleid"/>
			<property name="group" type="object" class="CGroup" column="groupid"/>
		</properties>
	</class>
	<class name="CGroup" abstract="sql" table="sys_group" security="public">
		<properties>
			<property name="id" type="text" column="id" readonly="true"/>
			<property name="name" type="text" column="name" required="true"/>
			<property name="description" type="text" column="description"/>
		</properties>
		<references>
			<reference class="CAccess" fkey="group"/>
		</references>
	</class>
	<class name="CAccess" abstract="sql" table="sys_access" security="public">
		<properties>
			<property name="viewname" type="text" column="view"/>
			<property name="access" type="text" column="access"/>
			<property name="group" type="object" class="CGroup" column="groupid"/>
		</properties>
	</class>

</taxonomy>

<!-- Copyright (C) 2004-2005 Kevin Jacovelli, All Rights Reserved -->
