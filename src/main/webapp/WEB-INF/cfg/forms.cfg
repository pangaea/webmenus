<?xml version="1.0" encoding="UTF-8"?>

<!-- Copyright (C) 2004-2008 Kevin Jacovelli, All Rights Reserved -->

<!--
	D A T A S P H E R E :   S E R V E R   T A X O N O M Y   F I L E
	===============================================================
	This is the server taxonomy file. It describes the "Business Layer Classes"
	of the server. All classes described here inherit from
	a single base class called "ServerObject". This classes implements three
	methods called "query", "insert", "update", and "delete".

	Abstracts:
	> sql - simply specifies a SQL storage device

	Method Calls:
	> These define how a request will be routed to the appropriate place
		> Global Calls - 	Calls not requiring a class reference
							and not associated to an object.
								> login() : login to server
								> logout() : logout of server
		> Class Calls - 	Calls which reference a class but not an object.
								> query() : request for a collection of objects
								> insert() : inserts new object of type <class>
		> Object Calls - 	Object level calls, otherwise referred to as "methods".
								> update() : make changes to local object
								> delete() : deletes local object

	Rules:
	1) You cannot name a property "class", "id", "owner", "created", "author", "modified", or "role".
	   These are reserved words representing object metadata.
-->

<taxonomy version="1.0">

	<class name="CTCFormRef" abstract="sql" table="forms" security="public">
		<properties>
			<property name="id" type="text" column="id" readonly="true"/>
			<property name="concept" type="int" column="concept"/>
			<property name="type" type="text" column="type"/>
			<property name="title" type="text" column="title"/>
			<property name="questcount" type="int" column="questcount"/>
			<property name="status" type="text" column="status"/>
		</properties>
	</class>
	<class name="CTCForm" abstract="sql" table="forms" security="public">
		<properties>
			<property name="id" type="text" column="id" readonly="true"/>
			<property name="concept" type="int" column="concept"/>
			<!--property name="parent" type="object" class="CTCFormRef" column="parentid"/-->
			<property name="type" type="text" column="type"/>
			<property name="title" type="text" column="title"/>
			<property name="questcount" type="int" column="questcount"/>
			<property name="status" type="text" column="status"/>
		</properties>
		<references>
			<reference class="CTCCategory" fkey="form"/>
			<reference class="CTCQuestion" fkey="form"/>
		</references>
	</class>
	<class name="CTCCategory" abstract="sql" table="forms_categories" security="public">
		<properties>
			<property name="form" type="object" class="CTCForm" column="formid"/>
			<property name="category" type="int" column="category"/>
			<property name="description" type="text" column="description"/>
			<property name="difficulty" type="text" column="difficulty"/>
		</properties>
	</class>
	<class name="CTCQuestion" abstract="sql" table="forms_questions" security="public"
		   postInsert="autoSequencer.pl"
		   postUpdate="autoSequencer.pl"
		   postDelete="autoSequencer.pl">
		<properties>
			<property name="form" type="object" class="CTCForm" column="formid"/>
			<property name="concept" type="int" column="concept"/>
        	<property name="number" type="int" column="number"/>
			<property name="type" type="text" column="type"/>
			<!--property name="category" type="int" column="category"/>
			<property name="difficulty" type="text" column="difficulty"/-->
			<property name="body" type="text" column="body"/>
		</properties>
		<references>
			<reference class="CTCInput" fkey="questnum"/>
			<reference class="CTCParam" fkey="questnum"/>
		</references>
	</class>
	<class name="CTCInput" abstract="sql" table="forms_inputs" security="public">
		<properties>
			<property name="questnum" type="object" class="CTCQuestion" column="questnum"/>
			<property name="number" type="int" column="number"/>
			<property name="display" type="text" column="display"/>
			<property name="type" type="text" column="type"/>
			<property name="body" type="text" column="body"/>
		</properties>
	</class>
	<class name="CTCParam" abstract="sql" table="forms_questions_params" security="public">
		<properties>
			<property name="questnum" type="object" class="CTCQuestion" column="questnum"/>
			<property name="name" type="text" column="name"/>
			<property name="value" type="text" column="value"/>
		</properties>
	</class>
	-----------
	<class name="CTCWorkgroup" abstract="sql" table="workgroups" security="public">
		<properties>
			<property name="name" type="text" column="name"/>
			<property name="description" type="text" column="description"/>
		</properties>
	</class>
	<class name="CTCWorkgroupUserRef" abstract="sql" table="workgroups_users_ref" security="public">
		<properties>
			<property name="workgroup" type="object" class="CTCWorkgroup" column="workgroupid"/>
			<property name="user" type="object" class="CUser" column="userid"/>
		</properties>
	</class>
	<class name="CTCWorkgroupFormIssuance" abstract="sql" table="workgroups_forms_issuance" security="public">
		<properties>
			<property name="id" type="text" column="id" readonly="true"/>
			<property name="created" type="text" column="created" readonly="true"/>
			<property name="workgroup" type="object" class="CTCWorkgroup" column="workgroupid"/>
			<property name="form" type="object" class="CTCForm" column="formid"/>
			<property name="active" type="boolean" column="active"/>
			<property name="notes" type="text" column="notes"/>
		</properties>
	</class>
	<class name="CTCWorkgroupStaticFormIssuance" abstract="sql" table="workgroups_sforms_issuance" security="public">
		<properties>
			<property name="id" type="text" column="id" readonly="true"/>
			<property name="created" type="text" column="created" readonly="true"/>
			<property name="workgroup" type="object" class="CTCWorkgroup" column="workgroupid"/>
			<property name="form" type="text" column="view"/>
			<property name="active" type="boolean" column="active"/>
			<property name="title" type="text" column="title"/>
			<property name="notes" type="text" column="notes"/>
		</properties>
	</class>
	<class name="CTCFormResponse" abstract="sql" table="users_forms_responses" security="public">
		<properties>
			<property name="user" type="object" class="CUser" column="userid"/>
			<!--property name="fullname" type="text" column="fullname"/-->
			<property name="form" type="object" class="CTCForm" column="formid"/>
			<property name="issuance" type="object" class="CTCWorkgroupFormIssuance" column="issid"/>
			<property name="response_time" type="datetime" column="response_time"/>
			<property name="type" type="int" column="type"/>
			<property name="grade" type="int" column="grade"/>
		</properties>
	</class>
	<class name="CTCUserQuestionResponse" abstract="sql" table="users_questions_responses" security="public">
		<properties>
			<property name="response" type="object" class="CTCFormResponse" column="responseid"/>
			<property name="responsenum" type="int" column="responsenum"/>
			<property name="questnum" type="int" column="questnum"/>
			<property name="answer" type="text" column="answer"/>
		</properties>
	</class>

</taxonomy>
